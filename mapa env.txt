

### ğŸ“‹ Mapa de VariÃ¡veis do `.env`

| VariÃ¡vel                                                  | Onde Ã© usada                                    | FunÃ§Ã£o                                             |
| --------------------------------------------------------- | ----------------------------------------------- | -------------------------------------------------- |
| **NODE_ENV**                                              | `server.js`, logs                               | Define ambiente (`production`, `development`)      |
| **PORT**                                                  | `server.js`                                     | Porta que o Express escuta                         |
| **DATABASE_URL**                                          | `db.js`                                         | ConexÃ£o Ãºnica ao banco (Postgres via Railway)      |
| **PGPOOL_MIN / PGPOOL_MAX / PGPOOL_IDLE_TIMEOUT**         | `db.js`                                         | Configura pool de conexÃµes                         |
| **JWT_SECRET**                                            | `authMiddleware.js`, `authController.js`        | Assinar/verificar tokens JWT                       |
| **JWT_EXPIRES_IN**                                        | `authController.js`                             | Tempo de expiraÃ§Ã£o dos tokens                      |
| **PICPAY_CLIENT_ID / PICPAY_CLIENT_SECRET**               | `picpayService.js`                              | AutenticaÃ§Ã£o na API PicPay                         |
| **PICPAY_CALLBACK_URL**                                   | `paymentWebhookController.js`                   | URL que recebe notificaÃ§Ãµes do PicPay              |
| **PICPAY_RETURN_URL**                                     | `paymentController.js`                          | Redireciona usuÃ¡rio apÃ³s pagamento                 |
| **PICPAY_API_BASE**                                       | `picpayService.js`                              | Endpoint da API PicPay                             |
| **ENABLE_PICPAY_POLLING**                                 | `picpayPollingJob.js`                           | Liga/desliga job de polling PicPay                 |
| **PICPAY_POLL_BATCH**                                     | `picpayPollingJob.js`                           | Quantidade de pagamentos checados por rodada       |
| **PICPAY_POLL_INTERVAL_MS**                               | `picpayPollingJob.js`                           | Intervalo de checagem (ms)                         |
| **TEF_API_KEY**                                           | `paymentController.js` (futuro)                 | IntegraÃ§Ã£o com outro meio de pagamento             |
| **PAYMENT_MODE**                                          | `paymentController.js`                          | Define se pagamentos sÃ£o `test` ou `production`    |
| **PLATFORM_USER_ID**                                      | `walletController.js`, `ledgerService.js`       | ID da carteira da plataforma                       |
| **PLATFORM_FEE_PERCENT**                                  | `payoutService.js`, `ledgerService.js`          | Percentual da taxa da plataforma                   |
| **MIN_PAYOUT_AMOUNT**                                     | `withdrawController.js`                         | Valor mÃ­nimo para solicitar saque                  |
| **PAYOUT_SCHEDULE**                                       | `payoutJob.js`                                  | Agendamento de pagamentos automÃ¡ticos              |
| **SMTP_HOST / SMTP_PORT / SMTP_USER / SMTP_PASS**         | `authController.js`                             | Envio de e-mails (recuperaÃ§Ã£o senha, notificaÃ§Ãµes) |
| **FRONTEND_URL**                                          | `authController.js`, `paymentController.js`     | Links de retorno para o app/web                    |
| **STORAGE_PROVIDER**                                      | `uploadService.js` (ou controllers de arquivos) | Define onde arquivos vÃ£o (local/S3)                |
| **S3_BUCKET / S3_REGION / S3_ACCESS_KEY / S3_SECRET_KEY** | `uploadService.js`                              | ConfiguraÃ§Ã£o AWS S3                                |
| **LOG_LEVEL**                                             | `logger.js`                                     | Define nÃ­vel de logs (debug, info, warn, error)    |
| **ENABLE_REQUEST_LOGS**                                   | `server.js` (middleware)                        | Habilita/desabilita logs de requests               |
| **REDIS_URL**                                             | `cacheService.js`, `sessionService.js`          | Usado para cache e filas                           |

---


                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚        .env         â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚ (dotenv)
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚     config/db.js    â”‚ â†â”€â”€ DATABASE_URL, PGPOOL_*
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚     models/*        â”‚  (schemas SQL)
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚    services/*       â”‚
                         â”‚  - picpayService    â”‚ â†â”€â”€ PICPAY_*
                         â”‚  - payoutService    â”‚ â†â”€â”€ PLATFORM_FEE, SCHEDULE
                         â”‚  - ledgerService    â”‚
                         â”‚  - uploadService    â”‚ â†â”€â”€ STORAGE_PROVIDER, S3_*
                         â”‚  - cacheService     â”‚ â†â”€â”€ REDIS_URL
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  controllers/*      â”‚
                         â”‚  - authController   â”‚ â†â”€â”€ JWT_SECRET, SMTP_*
                         â”‚  - paymentControllerâ”‚ â†â”€â”€ PAYMENT_MODE
                         â”‚  - withdrawControllerâ”‚ â†â”€â”€ MIN_PAYOUT_AMOUNT
                         â”‚  - walletController â”‚ â†â”€â”€ PLATFORM_USER_ID
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚    routes/*         â”‚
                         â”‚  - authRoutes       â”‚
                         â”‚  - paymentRoutes    â”‚
                         â”‚  - adminRoutes      â”‚
                         â”‚  - withdrawRoutes   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚     server.js       â”‚ â†â”€â”€ PORT, NODE_ENV
                         â”‚   (inicializa app)  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
